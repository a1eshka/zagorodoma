{% extends 'base.html' %}
{% load static %}
{% block content %}
<div style="display: flex;
flex-direction: column;
margin: 0 auto;
max-width: 1180px;
min-width: 320px;
width: 100%;">
<div class="main-filter">
  <div style="float:left;margin-right: 10px;">
    <select id="typeobj" name="categories" multiple>
      {% for typeobj in view.get_typeobjects %}
      <option value="{{ typeobj.id }}" data-badge="" class="filter-checkbox" data-filter="type_object" name="type_object">{{ typeobj.title }}</option>
      {% endfor %}
    </select>
  </div>
  <div style="float:left;margin-right: 10px;">
    
    <select id="getstatus" multiple="multiple" >
    {% for status in view.get_status %}
    <option class="filter-checkbox" data-filter="status" name="status" value="{{ status.id }}">
    {{ status.title }}</option>
    {% endfor %}
  </select>
  </div>
  <div style="float:left;margin-right: 10px;">
    
    <select id="landstat" name="land" multiple>
      {% for lands in view.get_landstatus %}
      <option value="{{ lands.id }}" data-badge="" class="filter-checkbox" data-filter="land_status" name="land_status">{{ lands.title }}</option>
      {% endfor %}
    </select>
  </div>
  <div style="float: left;margin-right: 80px;">
    
    <input class="form-control" style="max-width: 115px;float: left;margin-right: 5px;border: 1px solid #ffffff;" name="minPrice" id="minPrice" placeholder="Цена от"/>
    <input class="form-control" style="max-width: 115px;border: 1px solid #ffffff;" name="maxPrice" id="maxPrice" placeholder="Цена до"/>
  </div>
  <div id="floors" style="float: left;margin-right: 10px;display:none;clear: both;margin-top: 10px;">
    <div style="color: #aaa;">Этажей:</div>
    <input class="form-control" style="width: 70px;float: left;margin-right: 5px;border: 1px solid #ffffff;" name="minFloors" id="minFloors" placeholder="от"/>
    <input class="form-control" style="width: 70px;border: 1px solid #ffffff;" name="maxFloors" id="maxFloors" placeholder="до"/>
  </div>
 
  <div id="Land_area" style="float: left;margin-right: 10px;display:none;margin-top: 10px;">
    <div style="color: #aaa;">S участка:</div>
    <input class="form-control" style="width: 70px;float: left;margin-right: 5px;border: 1px solid #ffffff;" name="minLand_area" id="minLand_area" placeholder="от"/>
    <input class="form-control" style="width: 70px;float: left;border: 1px solid #ffffff;" name="maxLand_area" id="maxLand_area"  id="maxLand_area" placeholder="до"/>
  </div>
  <div id="housemat" style="float:left;margin-right: 10px;display:none;margin-top: 10px;">
    <div style="color: #aaa;">Материал дома:</div>
    <select id="housematerial" name="house_material" multiple>
      {% for housem in view.get_housematerial %}
      <option value="{{ housem.id }}" data-badge="" class="filter-checkbox" data-filter="house_material" name="house_material">{{ housem.title }}</option>
      {% endfor %}
    </select>
  </div>
  <div id="distr" style="float:left;margin-right: 10px;display:none;margin-top: 10px;">
    <div style="color: #aaa;">Район:</div>
    <select id="district" name="district" multiple>
      {% for district in view.get_district %}
      <option value="{{ district.id }}" data-badge="" class="filter-checkbox" data-filter="district" name="district">{{ district.title }}</option>
      {% endfor %}
    </select>
  </div>
  <button id="showHideContent" class="btn" style="color: #4e4e4e !important;background-color: rgb(82 68 216 / 10%) !important;">Все фильтры</button>
  <button id="PriceFilter" class="btn" id="btn" style="color: #5143d6 !important;background-color: rgb(82 68 216 / 10%) !important;">Найти</button>
</div>
<div class="main-text-title">Объекты в продаже ({{total_data}}):</div>
<div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3" id="filteredProducts" style="max-width: 1000px;margin: 15px;" >
 {% for post in object_list %}
  {% if post.pub %}
  {% else %}
  <div class="advert post-box">
    <div class="card-min">
      <div class="slider">
      {% for all_images in post.all_images.all %}
        <img src="{{ all_images.image_data_link.url }}" class="rounded" style="height: 220px;" alt="продукт">
      {% endfor %}     
    </div>
    <span class="badge bg-success" {% if post.status.id == 2 %} style="background-color: #27CB58 !important;border-radius: 0% 5px 5px 0%;" {% endif %} {% if post.status.id == 3 %} style="background-color: #53687E !important;border-radius: 0% 5px 5px 0%;" {% endif %}>{{post.status}}</span>
      <div class="card-body">
        <h5 class="card-title"><a style="color:#3A4454;" href="{% url 'post_detail' post.pk %}" target="_blank">{{ post.type_object}} · {% if post.square %} {{post.square|default_if_none:""}} м² ·{% endif %} {{post.land_area }} сот. · {{post.land_status}}</a></h5>
        <p class="min-card-adress">{{ post.adress}}</p>
        <h4 class="price-main-card">{{ post.price }} ₽</h4>
        <!--<p class="min-card-text">{{ post.body|slice:":100" }}...<a href="{% url 'post_detail' post.pk %}" target="_blank">Читать далее</a></p>!-->
      </div>
      {% if post.todaytime %}
          <div class="card-footer" style="background: white;"> 
            <small class="text-muted"><i class="bi bi-clock-history"></i> Сегодня в {{post.created_at|time:"H:i"}} </small>
          </div>
        {% else %}
          <div class="card-footer" style="background: white;"> 
            <small class="text-muted">{{post.created_at}}</small>
          </div>
      {% endif %}
    </div>    
  </div>
  {% endif %}
{% endfor %}
</div>
<button type="button" id="loadMore" data-limit="6" data-total="{{total_data}}" class="btn btn-secondary btnload" style="margin: 0 auto;display: block;width: 200px;margin-top: 40px;">Показать еще</button>
<div class="alert alert-success alert-dismissible fade show not-visible" role="alert" id="alert" style="max-width: 990px;
margin-left: 20px;
margin-right: 20px;">
  <i class="bi bi-check-circle-fill"></i> Всё уже просмотрено
  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>
</div>



<script type="text/javascript">
$(".dropdown dt a").on('click', function() {
  $(".dropdown dd ul").slideToggle('fast');
});

$(".dropdown dd ul li a").on('click', function() {
  $(".dropdown dd ul").hide();
});

function getSelectedValue(id) {
  return $("#" + id).find("dt a span.value").html();
}

$(document).bind('click', function(e) {
  var $clicked = $(e.target);
  if (!$clicked.parents().hasClass("dropdown")) $(".dropdown dd ul").hide();
});

$('.mutliSelect input[type="checkbox"]').on('click', function() {

  var title = $(this).closest('.mutliSelect').find('input[type="checkbox"]').val(),
    title = $(this).val() + ",";

  if ($(this).is(':checked')) {
    var html = '<span title="' + title + '">' + title + '</span>';
    $('.multiSel').append(html);
    $(".hida").hide();
  } else {
    $('span[title="' + title + '"]').remove();
    var ret = $(".hida");
    $('.dropdown dt a').append(ret);

  }
});
$(function(){
        $('#line-wrap-example').multiSelect({
            positionMenuWithin: $('.position-menu-within')
        });
        $('#typeobj').multiSelect({
            noneText: 'Тип объекта',
            
        });
        $('#getstatus').multiSelect({
            noneText: 'Тип сделки',
            
        });
        $('#landstat').multiSelect({
            noneText: 'Статус участка',
            
        });
        $('#housematerial').multiSelect({
            noneText: 'Материал дома',
            
        });
        $('#district').multiSelect({
            noneText: 'Район',
            
        });
        $('#modal-example').multiSelect({
            'modalHTML': '<div class="multi-select-modal">'
        });
    });


    $(document).ready(function(){
    $("#showHideContent").click(function () {
        if ($("#Land_area").is(":hidden")) {
            $("#Land_area").show();
        } else {
            $("#Land_area").hide();
        }
        if ($("#floors").is(":hidden")) {
            $("#floors").show();
        } else {
            $("#floors").hide();
        }
        if ($("#housemat").is(":hidden")) {
            $("#housemat").show();
        } else {
            $("#housemat").hide();
        }
        if ($("#distr").is(":hidden")) {
            $("#distr").show();
        } else {
            $("#distr").hide();
        }
        return false;
    });
});
    

</script>
<script src="{% static 'js/loadMoresale.js' %}" type="text/javascript"></script>
{% endblock content %}
